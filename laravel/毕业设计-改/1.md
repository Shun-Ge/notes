# 创建项目
1. `code ~/Homestead/Homestead.yaml` => 增加 homestead 中的站点和数据库
```
# 站点配置
sites:
    # gydiner
    - map: gydiner.test
      to: /home/vagrant/Code/gydiner/public

# 数据库名称
databases:
    # gydiner
    - gydiner
```
2. `notepad C:/Windows/System32/Drivers/etc/hosts` => 增加 hosts , 以便在 windows 中访问项目（需要以管理员身份执行命令）
```
192.168.10.10 gydiner.test
```
3. `cd ~/Homestead && vagrant up` 开启 homestead , `vagrant ssh` 登陆 homestead , `cd ~/Code` 切换到存放代码的目录, `composer create-project laravel/laravel gydiner --prefer-dist "5.5.*"` => 创建名为 gydiner (广元食客) 的项目。
4. `cd ~/Homestead && vagrant provision` => 让 homestead 读取最新的配置文件信息, 此时会读取 Homestead.yaml 配置信息，创建新的虚拟站点和数据库。
5. 访问 http://gydiner.test/ 即可看到部署好的 laravel 框架，用编辑器打开项目，作一些配置
    * 编辑 .env
    ```
    APP_NAME=gydiner
    ...
    APP_URL=http://gydiner.test/
    ...
    DB_DATABASE=gydiner
    ```
    * 编辑 config/app.php => 设置时区和语言
    ```
    'timezone' => 'PRC',
    'locale' => 'zh-CN',
    ```
6. git 托管
    * 创建 [新的 Git 仓库](https://github.com/new)
    * 在项目目录执行
    ```
    git init
    git add .
    git commit -m "初始化"
    git remote add origin "新仓库的 ssh 地址"
    git push -u origin master
    ```

# 助手函数
1. 创建 bootstrap/helpers.php
```
<?php

/**
 * 根据路由动态变化布局模板 div 的 class
 */
function route_class()
{
    return str_replace('.', '-', Route::currentRouteName());
}
```
2. 编辑 composer.json 
```
...
"autoload": {
    "classmap": [
        "database/seeds",
        "database/factories"
    ],
    "psr-4": {
        "App\\": "app/"
    },
    // 增加
    "files": [
        "bootstrap/helpers.php"
    ]
},
...
```
3. 执行 `composer dumpautoload`

# 布局视图
* 创建 ../layouts/app.blade.php 作为前台布局模板
    * _header.blade.php 作为头部导航模板
    * _footer.blade.php 作为脚部模板
* 创建 ../layouts/dealer.blade.php 作为门店管理布局模板
    * _menu.blade.php 作为侧边菜单栏模板
* 其余视图在后续开发中完成，笔记不记录视图的具体内容和样式，只记录 js 相关代码。

# 首页控制器
1. 创建控制器 `php artisan make:controller PagesController`
```
<?php

namespace App\Http\Controllers;

use Illuminate\Http\Request;

/**
 * 静态页面展示控制器
 */
class PagesController extends Controller
{
    /**
     * 首页
     */
    public function root()
    {
        return view('pages.root');
    }
}
```
2. 配置路由 routes/web.php
```
<?php
/**
 * 公开路由
 */
Route::get('/', 'PagesController@root')->name('root'); //首页
```
3. 视图：创建 ../pages/root.blade.php => 继承 app.blade.php, 填充 content。

# Yarn 与前端扩展
> 所有样式都写在 resources/assets/sass/app.scss 中，但是现在还没装 npm 包，不能用 laravel-mix 编译写好的 app.scss 样式
1. `yarn config set registry  https://registry.npm.taobao.org` 设置 Yarn 下载地址为淘宝镜像
2. 装扩展 `yarn install --no-bin-links`
3. 修改 package.json
```
"scripts":{
    "dev": "npm run development",
    "development": "NODE_ENV=development node_modules/webpack/bin/webpack.js --progress --hide-modules --config=node_modules/laravel-mix/setup/webpack.config.js",
    "watch": "NODE_ENV=development node_modules/webpack/bin/webpack.js --watch --progress --hide-modules --config=node_modules/laravel-mix/setup/webpack.config.js",
    "watch-poll": "npm run watch -- --watch-poll",
    "hot": "NODE_ENV=development node_modules/webpack-dev-server/bin/webpack-dev-server.js --inline --hot --config=node_modules/laravel-mix/setup/webpack.config.js",
    "prod": "npm run production",
    "production": "NODE_ENV=production node_modules/webpack/bin/webpack.js --progress --hide-modules --config=node_modules/laravel-mix/setup/webpack.config.js"
},
```
> 在 windows.homestead 中用 Yarn 都得加参数 --no-bin-links